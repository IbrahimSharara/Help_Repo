â— ğŸ” Route Encryption System

  Why Use This?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚      Without Encryption       â”‚        With Encryption         â”‚                                                                                                          
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                                                                          
  â”‚ /project?id=123               â”‚ /project?SQ=x7Kp2mN...         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ âŒ User can change 123 to 456 â”‚ âœ… User cannot guess other IDs â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ âŒ Exposes database IDs       â”‚ âœ… IDs are hidden              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  ---
  How It Works

      ğŸ“± FRONTEND                           ğŸ–¥ï¸ BACKEND

      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ User clicks  â”‚                     â”‚              â”‚
      â”‚ "View #123"  â”‚                     â”‚              â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚              â”‚
             â”‚                             â”‚              â”‚
             â”‚  â‘  GET /api/Encrypt/id=123  â”‚              â”‚
             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚   ENCRYPT    â”‚
             â”‚                             â”‚   id=123     â”‚
             â”‚  â‘¡ { result: "x7Kp2mN..." } â”‚      â†“       â”‚
             â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   x7Kp2mN... â”‚
             â”‚                             â”‚              â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚   Navigate   â”‚
      â”‚ /project?SQ= â”‚
      â”‚  x7Kp2mN...  â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚         PAGE LOADS
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  Read SQ     â”‚                     â”‚              â”‚
      â”‚  from URL    â”‚                     â”‚              â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚              â”‚
             â”‚                             â”‚              â”‚
             â”‚  â‘¢ POST /api/Decrypt        â”‚              â”‚
             â”‚    { query: "x7Kp2mN...",   â”‚   DECRYPT    â”‚
             â”‚      key: "id" }            â”‚   x7Kp2mN... â”‚
             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚      â†“       â”‚
             â”‚                             â”‚   id=123     â”‚
             â”‚  â‘£ { result: "123" }        â”‚              â”‚
             â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚              â”‚
             â”‚                             â”‚              â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚ Load project â”‚
      â”‚   ID: 123    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  ğŸ–¥ï¸ BACKEND (C#)

  ğŸ“ File Structure

  YourProject/
  â”œâ”€â”€ appsettings.json           â† Keys configuration
  â”œâ”€â”€ Models/
  â”‚   â””â”€â”€ EncryptionSettings.cs  â† Settings class
  â”œâ”€â”€ Services/
  â”‚   â””â”€â”€ EncryptionService.cs   â† Encrypt/Decrypt logic
  â”œâ”€â”€ Controllers/
  â”‚   â””â”€â”€ EncryptionController.cs â† API endpoints
  â””â”€â”€ Program.cs                  â† Register services

  ---
  1ï¸âƒ£ Configuration                                                                                                                                                           


  appsettings.json
  {
    "EncryptionSettings": {
      "Key": "YourSecretKey12345678",
      "Salt": "YourSaltValue12345678"
    }
  }

  âš ï¸ Important: Use strong, unique values. Never commit real keys to git!

  ---
  2ï¸âƒ£ Settings Model                                                                                                                                                          


  Models/EncryptionSettings.cs
  public class EncryptionSettings
  {
      public string Key { get; set; } = string.Empty;
      public string Salt { get; set; } = string.Empty;
  }

  ---
  3ï¸âƒ£ Encryption Service                                                                                                                                                      


  Services/EncryptionService.cs
  using System.Security.Cryptography;
  using System.Text;
  using System.Web;
  using Microsoft.Extensions.Options;

  public class EncryptionService
  {
      private readonly string _key;
      private readonly string _salt;

      public EncryptionService(IOptions<EncryptionSettings> settings)
      {
          _key = settings.Value.Key;
          _salt = settings.Value.Salt;
      }

      /// <summary>
      /// Encrypts a query string like "id=123" â†’ "x7Kp2mN..."
      /// </summary>
      public string Encrypt(string plainText)
      {
          var plainBytes = Encoding.UTF8.GetBytes(plainText);
          var keyBytes = GetKeyBytes();

          using var aes = Aes.Create();
          aes.Key = keyBytes.Key;
          aes.IV = keyBytes.IV;
          aes.Mode = CipherMode.CBC;
          aes.Padding = PaddingMode.PKCS7;

          using var encryptor = aes.CreateEncryptor();
          using var ms = new MemoryStream();
          using var cs = new CryptoStream(ms, encryptor, CryptoStreamMode.Write);

          cs.Write(plainBytes, 0, plainBytes.Length);
          cs.FlushFinalBlock();

          return Convert.ToBase64String(ms.ToArray());
      }

      /// <summary>
      /// Decrypts "x7Kp2mN..." â†’ "id=123"
      /// </summary>
      public string Decrypt(string encryptedText)
      {
          var encryptedBytes = Convert.FromBase64String(encryptedText);
          var keyBytes = GetKeyBytes();

          using var aes = Aes.Create();
          aes.Key = keyBytes.Key;
          aes.IV = keyBytes.IV;
          aes.Mode = CipherMode.CBC;
          aes.Padding = PaddingMode.PKCS7;

          using var decryptor = aes.CreateDecryptor();
          using var ms = new MemoryStream(encryptedBytes);
          using var cs = new CryptoStream(ms, decryptor, CryptoStreamMode.Read);
          using var output = new MemoryStream();

          cs.CopyTo(output);
          return Encoding.UTF8.GetString(output.ToArray());
      }

      /// <summary>
      /// Gets a specific value from decrypted query string
      /// "id=123&name=test" + key "id" â†’ "123"
      /// </summary>
      public string? GetValue(string queryString, string key)
      {
          var parsed = HttpUtility.ParseQueryString(queryString);
          return parsed[key];
      }

      /// <summary>
      /// Derives key and IV from password and salt
      /// </summary>
      private (byte[] Key, byte[] IV) GetKeyBytes()
      {
          using var deriveBytes = new Rfc2898DeriveBytes(
              _key,
              Encoding.UTF8.GetBytes(_salt),
              10000,
              HashAlgorithmName.SHA256
          );

          return (
              Key: deriveBytes.GetBytes(32),  // 256 bits
              IV: deriveBytes.GetBytes(16)    // 128 bits
          );
      }
  }

  ---
  4ï¸âƒ£ Controller                                                                                                                                                              


  Controllers/EncryptionController.cs
  using Microsoft.AspNetCore.Authorization;
  using Microsoft.AspNetCore.Mvc;

  [ApiController]
  [Authorize]  // ğŸ”’ Requires authentication
  public class EncryptionController : ControllerBase
  {
      private readonly EncryptionService _encryption;

      public EncryptionController(EncryptionService encryption)
      {
          _encryption = encryption;
      }

      /// <summary>
      /// ENCRYPT: "id=123" â†’ "x7Kp2mN..."
      /// </summary>
      [HttpGet("api/EncqStringnourlenc/{query}")]
      public IActionResult Encrypt(string query)
      {
          try
          {
              var result = _encryption.Encrypt(query);
              return Ok(new { result });
          }
          catch
          {
              return BadRequest(new { error = "Encryption failed" });
          }
      }

      /// <summary>
      /// DECRYPT: "x7Kp2mN..." â†’ "123"
      /// </summary>
      [HttpPost("api/DecqString")]
      public IActionResult Decrypt([FromBody] DecryptRequest request)
      {
          try
          {
              var decrypted = _encryption.Decrypt(request.Decquerystring);
              var value = _encryption.GetValue(decrypted, request.Key);
              return Ok(new { result = value });
          }
          catch
          {
              return BadRequest(new { error = "Decryption failed" });
          }
      }
  }

  // Request model
  public class DecryptRequest
  {
      public string Decquerystring { get; set; } = string.Empty;
      public string Key { get; set; } = string.Empty;
  }

  ---
  5ï¸âƒ£ Register Services                                                                                                                                                       


  Program.cs
  // Add this before builder.Build()

  builder.Services.Configure<EncryptionSettings>(
      builder.Configuration.GetSection("EncryptionSettings")
  );

  builder.Services.AddSingleton<EncryptionService>();

  ---
  ğŸ“± FRONTEND (Angular)

  ğŸ“ File Structure

  src/app/
  â”œâ”€â”€ core/
  â”‚   â””â”€â”€ services/
  â”‚       â””â”€â”€ encryption.service.ts  â† Encrypt/Decrypt calls
  â””â”€â”€ features/
      â””â”€â”€ project/
          â”œâ”€â”€ project-list.component.ts    â† Navigate WITH encryption
          â””â”€â”€ project-detail.component.ts  â† Read FROM encryption

  ---
  1ï¸âƒ£ Encryption Service                                                                                                                                                      


  core/services/encryption.service.ts
  import { Injectable } from '@angular/core';
  import { HttpClient } from '@angular/common/http';
  import { Observable } from 'rxjs';

  @Injectable({ providedIn: 'root' })
  export class EncryptionService {

    private apiUrl = 'https://your-api.com';

    constructor(private http: HttpClient) {}

    /**
     * ENCRYPT: "id=123" â†’ "x7Kp2mN..."
     */
    encrypt(query: string): Observable<{ result: string }> {
      return this.http.get<{ result: string }>(
        `${this.apiUrl}/api/EncqStringnourlenc/${query}`
      );
    }

    /**
     * DECRYPT: "x7Kp2mN..." + "id" â†’ "123"
     */
    decrypt(encryptedQuery: string, key: string): Observable<{ result: string }> {
      return this.http.post<{ result: string }>(
        `${this.apiUrl}/api/DecqString`,
        {
          decquerystring: encryptedQuery,
          key: key
        }
      );
    }
  }

  ---
  2ï¸âƒ£ Navigate WITH Encryption                                                                                                                                                


  project-list.component.ts
  import { Component } from '@angular/core';
  import { Router } from '@angular/router';
  import { EncryptionService } from '@core/services/encryption.service';

  @Component({
    selector: 'app-project-list',
    template: `
      <div *ngFor="let project of projects">
        <span>{{ project.name }}</span>
        <button (click)="viewProject(project.id)">View</button>
      </div>
    `
  })
  export class ProjectListComponent {

    projects = [
      { id: 123, name: 'Project A' },
      { id: 456, name: 'Project B' }
    ];

    constructor(
      private router: Router,
      private encryption: EncryptionService
    ) {}

    viewProject(id: number): void {
      // Step 1: Encrypt the ID
      this.encryption.encrypt(`id=${id}`).subscribe({
        next: (response) => {
          // Step 2: Navigate with encrypted SQ
          this.router.navigate(['/project/detail'], {
            queryParams: { SQ: response.result }
          });
        },
        error: (err) => console.error('Encryption failed:', err)
      });
    }
  }

  ---
  3ï¸âƒ£ Read FROM Encryption                                                                                                                                                    


  project-detail.component.ts
  import { Component, OnInit } from '@angular/core';
  import { ActivatedRoute } from '@angular/router';
  import { EncryptionService } from '@core/services/encryption.service';

  @Component({
    selector: 'app-project-detail',
    template: `
      <div *ngIf="loading">Loading...</div>
      <div *ngIf="project">
        <h1>{{ project.name }}</h1>
      </div>
    `
  })
  export class ProjectDetailComponent implements OnInit {

    project: any;
    loading = true;

    constructor(
      private route: ActivatedRoute,
      private encryption: EncryptionService,
      private projectService: ProjectService
    ) {}

    ngOnInit(): void {
      // Step 1: Get SQ from URL
      const sq = this.route.snapshot.queryParams['SQ'];

      if (!sq) {
        console.error('No SQ parameter found');
        return;
      }

      // Step 2: Decrypt to get real ID
      this.encryption.decrypt(sq, 'id').subscribe({
        next: (response) => {
          const projectId = Number(response.result);

          // Step 3: Load data with decrypted ID
          this.loadProject(projectId);
        },
        error: (err) => console.error('Decryption failed:', err)
      });
    }

    loadProject(id: number): void {
      this.projectService.getById(id).subscribe(data => {
        this.project = data;
        this.loading = false;
      });
    }
  }

  ---
  ğŸ“‹ Quick Reference

  API Endpoints
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚            Endpoint             â”‚ Method â”‚ Purpose â”‚       Example       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ /api/EncqStringnourlenc/{query} â”‚ GET    â”‚ Encrypt â”‚ id=123 â†’ x7Kp2mN... â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ /api/DecqString                 â”‚ POST   â”‚ Decrypt â”‚ x7Kp2mN... â†’ 123    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Request/Response Examples

  Encrypt:
  GET /api/EncqStringnourlenc/id=123

  Response: { "result": "x7Kp2mNqR5tY8uW..." }

  Decrypt:
  POST /api/DecqString
  Body: { "decquerystring": "x7Kp2mNqR5tY8uW...", "key": "id" }

  Response: { "result": "123" }

  ---
  âœ… Checklist for New Project

  Backend

  - Add EncryptionSettings to appsettings.json
  - Create EncryptionSettings.cs model
  - Create EncryptionService.cs
  - Create EncryptionController.cs
  - Register services in Program.cs
  - Add [Authorize] to protect endpoints

  Frontend

  - Create EncryptionService
  - Use encrypt() before navigation
  - Use decrypt() on page load
  - Handle errors gracefully

  ---
  ğŸ”’ Security Tips
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                Do âœ…                â”‚            Don't âŒ             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Use HTTPS                           â”‚ Expose keys in code             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Use strong keys (20+ chars)         â”‚ Use simple keys like "password" â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Store keys in environment variables â”‚ Commit keys to git              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Require authentication              â”‚ Allow anonymous access          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Validate decrypted values           â”‚ Trust decrypted data blindly    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
